<html>
<head>
        <!-- Preconnect for faster DNS and TLS setup -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        
        <!-- Non-blocking preload for Castoro and Work Sans -->
        <link rel="preload" href="https://fonts.googleapis.com/css2?family=Castoro:ital@0;1&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
        
        <!-- Non-blocking preload for Material Symbols Outlined -->
        <link rel="preload" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <link rel="icon" href="data:,"/>

</head>

<body>
<style>
  html, body {
    height: 100%;
  }

*, *::before, *::after {
  box-sizing: border-box;
}


/*.work-sans-regular {
  font-family: "Work Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-style: normal;
}

.castoro-regular {
  font-family: "Castoro", Georgia, "Times New Roman", Times, serif;
  font-weight: 400;
  font-style: normal;
}

.castoro-regular-italic {
  font-family: "Castoro", Georgia, "Times New Roman", Times, serif;
  font-weight: 400;
  font-style: italic;
}*/

footer, header, main {
  font-family: "Castoro", Georgia, "Times New Roman", Times, serif;
  font-weight: 400;
  font-style: normal;
}

  body {
    margin: 0;      
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }
        
   main {
    flex: 1;
    display: flex;
    flex-direction: column;
   }

    #site-header {
      position: sticky;
      top: 0;
      z-index: 999;
      transition: background-color 0.3s ease;
    }

    #site-footer {
      width: 100%;
      margin-top: auto;            
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      background-color: #f8f8f8;
      font-size: 14px;
      color: #444;
      border-top: 1px solid #ddd;
    }

.footer-content {
  max-width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px;
  box-sizing: border-box;
  width: 100%;
}

        
    .footer-left,
    .footer-right {
      flex-shrink: 0;
    }

.footer-right div.container a {
  display: flex;
  align-items: center;
  gap: 0.4em; /* spacing between icon and text */
}        
.footer-right a {
  all: unset;
  cursor: pointer; /* Restores link-like behavior */
}

.magic-icon svg {
  width: 1em; 
  height: 1em;
  vertical-align: middle;
  font-size: 18px; /* scales with text if you prefer using em */
  display: block;
  fill: currentColor; /* uses inherited text color */
}

.magic-text, .blogger-text {
  font-size: 18px;
  line-height: 1.0
}

span.magic-icon svg {
  width: 18px !important; 
}

span.blogger-icon svg {
  height: 20px !important; 
  filter: grayscale(1);
}        


.footer-left {
  font-size: 18px;
  display: flex;
  align-items: center;
  gap: 0.4em; /* optional: space between icon and text */
}




    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: transparent;
      transition: background-color 0.3s ease;
    }

    .nav-section,
    .logo-section {
      flex-shrink: 0;
    }

    .search-section {
      flex-grow: 1;
      padding: 0 10px;
    }


.nav-section a, .menu-toggle-container .search-toggle  {
  font-size: 18px; 
  text-transform: uppercase;
  text-decoration: none;
  color: inherit;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 0 6px;
  height: 48px; /* Ensures consistent vertical alignment */
  line-height: 1;
}

html.main-page .nav-section a {
  color: white;
}        
        
/* Optional: Give nav-section horizontal layout and vertical centering */
.nav-section {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 8px;
}

html:not(.main-page) .logo-section img {
  width: 200px;
}

        
/* Icon styling (matches button height visually) */
.material-symbols-outlined {
  font-size: 26px;
  vertical-align: middle;
}

/* menu formatting */
.nav-section.collapsible-menu.open .top-menu-item, .nav-section.collapsible-menu.open #search-toggle-main {
    color: black !important;
}

        
      
.search-form {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  max-width: 400px;             /* Avoid overflow into nav or logo */
  margin: 0 auto;               /* Optional: center within available space */
}

.search-form input[type="text"] {
  flex-grow: 1;
  flex-shrink: 1;
  min-width: 0;                 /* Prevent weird flex overflow */
  padding: 6px 10px;
  font-size: 16px;
  height: 36px;
  box-sizing: border-box;
}

.search-form input[type="submit"] {
  flex-shrink: 0;
  flex-grow: 0;
  padding: 6px 12px;
  font-size: 16px;
  height: 36px;
  white-space: nowrap;
  width: auto;
  box-sizing: border-box;
  cursor: pointer;
}

/* Hide search form by default, show toggle link */
.search-section {
  display: none;
}

.search-toggle-link {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  text-decoration: none;
}

/* Use Material Symbols â€” make sure it's loaded */
.material-symbols-outlined {
  font-family: 'Material Symbols Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 20px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
}

/* When body class is set to show the full search box */
body.show-search-box .search-section {
  display: flex;
  justify-content: center;
  flex-grow: 1;
}

body.show-search-box .search-toggle-link {
  display: none;
}

html.main-page .search-section {
  transform: scale(1.1); 
}

        
    body.normal-order {
      flex-direction: row;
    }

    body.reversed-order {
      flex-direction: row-reverse;
    }

    /* When scrolled */
    body.scrolled header {
      background-color: white;
    }
    /* Styles when NOT scrolled */
    body:not(.scrolled) header {
      background-color: transparent;
    }  


/* Base styles */
.collapsible-menu {
  display: flex;
  gap: 1rem;
}

.collapsible-menu.open {
        top: 80px;
}        

        
/* Hamburger and search toggle container */
.menu-toggle-container {
  display: none;
  align-items: center;
  gap: 1rem;
}

/* Responsive styles */
@media (max-width: 866px) {
  .collapsible-menu {
    display: none;
    flex-direction: column;
    background: #fff;
    position: absolute;
    top: 60px; /* adjust based on header height */
    left: 0;
    right: 0;
    padding: 1rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);      
  }

  .collapsible-menu.open {
    display: flex;
  }

  .menu-toggle-container {
    display: flex;
  }

  .nav-section {
    order: 2;
  }

  .search-toggle-link {
    order: 1;
  }
}

@media (max-width: 500px) {
 #search-toggle-small .search-toggle-text {
         display: none;
 }
}
        
button.icon-button {
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: inherit; /* optional: inherit icon size from parent */
  color: inherit;     /* optional: inherit text/icon color */
}      


.search-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.search-wrapper input {
  width: 100%;
  padding: 10px 40px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

/* Button styling */
.search-button {
  position: absolute;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #666;
}

/* Icon inside button */
.search-button .material-symbols-outlined {
  font-size: 24px;
}

/* Positioning */
.search-wrapper.icon-left .search-button {
  left: 10px;
}

.search-wrapper.icon-right .search-button {
  right: 10px;
}

/* Adjust input padding */
.search-wrapper.icon-left input {
  padding-left: 40px;
  padding-right: 10px;
}

.search-wrapper.icon-right input {
  padding-left: 10px;
  padding-right: 40px;
}

/* hide default item */
html.main-page h3.post-title, html.main-page div.blog-pager {
    display: none;
}




/* work */

.image-frame {
  display: inline-block; /* shrink-wrap to content */
  padding: 10;             /* 0 for no extra space */
  margin: 0;
  line-height: 0;         /* remove whitespace gaps */

    box-shadow:
    0 1px 2px rgba(0, 0, 0, 0.05),      /* gentle top/left glow */
    2px 3px 8px rgba(0, 0, 0, 0.12);    /* richer bottom/right lift */
}


a.active-link {
  pointer-events: none;     /* Makes the link unclickable */
  color: gray;              /* Changes color to gray */
  text-decoration: none;    /* Optional: remove underline */
  cursor: default;          /* Optional: change cursor */
}

a.active-link.title-link{
 font-size: 26px;
}

.status-msg-hidden {
        display: none;
}

</style>
<script>

  document.addEventListener("DOMContentLoaded", function () {
          const searchToggles = document.querySelectorAll(".search-toggle");
        
          searchToggles.forEach(toggle => {
            toggle.addEventListener("click", function (e) {
              e.preventDefault();
              document.body.classList.toggle("show-search-box");
            });
          });


    const menuToggleBtn = document.getElementById('menu-toggle');
    const menuIcon = menuToggleBtn.querySelector('.material-symbols-outlined');
    const collapsibleMenu = document.querySelector('.collapsible-menu');
    const topSearchToggle = document.querySelector('.menu-toggle-container .search-toggle');

    function openMenu() {
      collapsibleMenu.classList.add('open');
      menuIcon.textContent = 'close';
      if (topSearchToggle) topSearchToggle.style.display = 'none';
    }

    function closeMenu() {
      collapsibleMenu.classList.remove('open');
      menuIcon.textContent = 'menu';
      if (topSearchToggle) topSearchToggle.style.display = '';
    }

    menuToggleBtn.addEventListener('click', function (e) {
      e.stopPropagation();
      if (collapsibleMenu.classList.contains('open')) {
        closeMenu();
      } else {
        openMenu();
      }
    });

    document.addEventListener('click', function (e) {
      if (
        collapsibleMenu.classList.contains('open') &&
        !collapsibleMenu.contains(e.target) &&
        !menuToggleBtn.contains(e.target)
      ) {
        closeMenu();
      }
    });

    const currentUrl = window.location.href.split("#")[0]; // Ignore hash
    const links = document.querySelectorAll("a[href]");

    links.forEach(link => {
      const linkUrl = new URL(link.href, document.baseURI).href.split("#")[0];
      if (linkUrl === currentUrl) {
        link.classList.add("active-link");
      }
    });

    const activeLink = document.querySelector(".nav-section .active-link");

    if (activeLink) {
      const container = activeLink.parentElement;
      activeLink.classList.add("title-link");
      container.insertBefore(activeLink, container.firstElementChild);
    }





    const magic = document.querySelector('.made-with-magic');
    const blogger = document.querySelector('.powered-by-blogger');
    let showingMagic = true;

    setInterval(() => {
      if (showingMagic) {
        magic.style.display = 'none';
        blogger.style.display = 'flex';
      } else {
        blogger.style.display = 'none';
        magic.style.display = 'flex';
      }
      showingMagic = !showingMagic;
    }, 12000); // Swaps every 12 seconds    
          
  });
       
window.addEventListener('scroll', () => {
  const isScrolled = window.scrollY > 10;
  document.body.classList.toggle('scrolled', isScrolled);
});


  // Toggle layout order (example switch)
  function toggleHeaderOrder() {
    document.body.classList.toggle('normal-order');
    document.body.classList.toggle('reversed-order');
  }
        
</script>

<header id="site-header">
  <nav class="header-container normal-order">

    <div class="menu-toggle-container">
      <button class="icon-button" id="menu-toggle" aria-label="Toggle menu">
        <span class="material-symbols-outlined">menu</span>
      </button>
      <a href="javascript:void(0)" id="search-toggle-small top-menu-item" class="search-toggle search-toggle-link">
        <span class="material-symbols-outlined">search</span> <span class="search-toggle-text">Search</span>
      </a>
    </div>
          
    <div class="nav-section collapsible-menu">
      <!-- menu entries go here -->            
      <a href="javascript:void(0)" id="search-toggle-main" class="search-toggle search-toggle-link top-menu-item">
          <span class="material-symbols-outlined">search</span> <span class="search-toggle-text">Search</span>
      </a>
    </div>

<div class="search-section">
  <form action="/search" method="get" class="search-form">
    <div class="search-wrapper icon-right"> <!-- Toggle icon-left or icon-right -->
      <input
        id="search-field"
        name="q"
        placeholder="Search the gallery..."
        type="text"
      />
      <button type="submit" class="search-button">
        <span class="material-symbols-outlined">search</span>
      </button>
    </div>
  </form>
</div>


          
    <div class="logo-section">
      <svg viewBox="0 0 100 40" width="80" height="40">
        <text x="0" y="30" font-size="30" font-family="sans-serif">netlands</text>
      </svg>
    </div>
  </nav>
</header>

<footer id="site-footer">
  <div class="footer-content">
          <div class="footer-left">
            <span class="placeholder copyright-symbol">&copy; 2025</span> <span class="sitename">netlands</span> Â· <span class="placeholder copyright-text style-editor">All rights reserved.</span>
          </div>
          <div class="footer-right">
            <div class="container">      
             <a href="https://www.netlands.com" class="made-with-magic" style="display:flex"><span class="magic-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10.6144 17.7956 11.492 15.7854C12.2731 13.9966 13.6789 12.5726 15.4325 11.7942L17.8482 10.7219C18.6162 10.381 18.6162 9.26368 17.8482 8.92277L15.5079 7.88394C13.7092 7.08552 12.2782 5.60881 11.5105 3.75894L10.6215 1.61673C10.2916.821765 9.19319.821767 8.8633 1.61673L7.97427 3.75892C7.20657 5.60881 5.77553 7.08552 3.97685 7.88394L1.63658 8.92277C.868537 9.26368.868536 10.381 1.63658 10.7219L4.0523 11.7942C5.80589 12.5726 7.21171 13.9966 7.99275 15.7854L8.8704 17.7956C9.20776 18.5682 10.277 18.5682 10.6144 17.7956ZM19.4014 22.6899 19.6482 22.1242C20.0882 21.1156 20.8807 20.3125 21.8695 19.8732L22.6299 19.5353C23.0412 19.3526 23.0412 18.7549 22.6299 18.5722L21.9121 18.2532C20.8978 17.8026 20.0911 16.9698 19.6586 15.9269L19.4052 15.3156C19.2285 14.8896 18.6395 14.8896 18.4628 15.3156L18.2094 15.9269C17.777 16.9698 16.9703 17.8026 15.956 18.2532L15.2381 18.5722C14.8269 18.7549 14.8269 19.3526 15.2381 19.5353L15.9985 19.8732C16.9874 20.3125 17.7798 21.1156 18.2198 22.1242L18.4667 22.6899C18.6473 23.104 19.2207 23.104 19.4014 22.6899Z"></path></svg></span><span class="magic-text">Built with magic in Tokyo</span></a>
             <a href="https://www.blogger.com" class="powered-by-blogger" style="display:none"><span class="blogger-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 179.51975 179.20429"><path fill="#f06a35" d="M20.512413 178.49886c-3.359449-.8837-6.258272-2.1837-8.931866-4.0056-2.256922-1.5379-5.555601-4.7174-6.810077-6.5637-1.532132-2.255-3.293254-6.1168-4.010994-8.795-.732062-2.7319-.743927-3.8198-.757063-69.39501-.01306-65.24411.0018-66.67877.719335-69.48264C3.259268 10.34132 11.117019 2.7971 21.251347.54646 24.165189-.10065 154.331139-.21383 157.47424.42803c8.508999 1.73759 15.197718 6.84619 19.06824 14.56362 3.07712 6.13545 2.80203-.61622 2.94296 72.23085.0897 46.34991.007 65.80856-.28883 68.23286-1.38576 11.3442-9.210679 20.1431-20.470153 23.0183-2.880202.7354-3.882129.7459-69.275121.7259-63.227195-.019-66.474476-.052-68.938923-.7007z"/>  <path fill="none" d="M-82.99522 87.83767V-84.06232h1020v343.79998h-1020V87.83767z"/>  <path fill="#fff" d="M115.16168 144.83466c8.064748-1.1001 14.384531-4.3325 20.313328-10.3896 4.288999-4.38181 6.973811-9.12472 8.728379-15.41921.728903-2.6149.790018-3.88807.923587-19.24149.100809-11.58796.01669-17.01514-.285075-18.38528-.437344-1.98593-1.67711-3.83016-3.091687-4.59911-.435299-.23661-3.224334-.53819-6.197859-.67015-4.982681-.22115-5.540155-.31832-7.11287-1.24-2.494681-1.46198-3.181724-3.04069-3.188544-7.32677-.01304-8.1894-3.421087-15.79237-10.154891-22.65435-4.797263-4.8886-10.14889-8.19759-16.256563-10.05172-1.462167-.44388-4.736105-.59493-15.7023605-.72452-17.2069763-.20332-21.0264035.14939-26.8842785 2.48265-10.799733 4.30168-18.559563 13.36742-21.390152 24.98992-.531646 2.18295-.634845 5.6815-.760427 25.77865-.157327 25.17748.01622 28.87467 1.589422 33.86414 1.299798 4.12233 2.611223 6.64844 5.312916 10.23388 5.146805 6.83036 12.860236 11.76336 20.572006 13.15646 3.669923.6631 48.94793.829 53.585069.1965z"/>  <path fill="#f06a35" d="M67.5750093 75.71747c-4.1229413-1.13646-5.6634683-7.05179-2.6332273-10.11109 1.9367555-1.95536 2.4721802-2.02981 14.5952492-2.02981 10.8833578 0 11.2491898.0238 12.8478758.83129 2.310253 1.16711 3.314106 2.81263 3.314106 5.43252 0 2.36619-.942769 4.0244-3.045645 5.35691-1.129143.71549-1.803912.76002-12.4672419.82265-6.5844803.0387-11.829856-.0872-12.6111168-.30247zm-.5165819 39.80858c-1.7697484-.77113-3.4178244-2.91327-3.7026534-4.81263-.271319-1.80929.637963-4.29669 2.031786-5.55809 1.7569755-1.59003 2.5280723-1.64307 24.134743-1.66008 22.226353-.0174 22.11068-.0268 24.218307 1.94113 2.976827 2.77944 2.348939 7.7279-1.238363 9.75964l-3.686323.59948-19.213121.22489c-16.8830622.19762-21.6656419-.1114-22.5443756-.49433z"/></svg></span> <span class="blogger-text">Powered by Blogger</span></a>                     
            </div>      
          </div>
  </div>        
</footer>
<div id="image-overlay">
  <button id="close-overlay">âœ•</button>
  <div id="zoom-container">
    <img id="zoomed-image" src="" alt="Artwork" draggable="false" />
  </div>
  <div id="image-caption"></div>
  <div id="zoom-preview">Zoom: 100%</div>
</div>


<style>
  :root {
    --overlay-bg: #111;
  }

#image-caption {
  position: absolute;
  bottom: 60px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(255, 255, 255, 0.9);
  padding: 6px 12px;
  font-size: 14px;
  border-radius: 4px;
  color: #333;
  font-family: sans-serif;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  display: none;
  max-width: 90%;
  text-align: center;
  white-space: pre-wrap;
}

#image-overlay.show-caption #image-caption {
  display: block;
}



  #image-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background-color: var(--overlay-bg);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    overflow: hidden;
  }

  #zoom-container {
    position: relative;
    cursor: grab;
    overflow: hidden;
    width: 100%;
    height: 100%;
  }

  #zoomed-image {
    max-width: none;
    max-height: none;
    transform-origin: center center;
    user-drag: none;
    user-select: none;
    pointer-events: auto;
    position: absolute;
    top: 0;
    left: 0;
  }

#zoomed-image {
  transform-origin: top left;
}



  #close-overlay {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #fff;
    border: none;
    font-size: 24px;
    padding: 5px 10px;
    cursor: pointer;
    z-index: 10000;
    border-radius: 4px;
  }

  #zoom-preview {
    position: absolute;
    bottom: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.9);
    padding: 6px 12px;
    font-size: 14px;
    border-radius: 4px;
    color: #333;
    z-index: 10000;
    font-family: sans-serif;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }

  img.view-original {
    cursor: pointer;
  }

</style>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const overlay = document.getElementById('image-overlay');
  const zoomedImage = document.getElementById('zoomed-image');
  const closeBtn = document.getElementById('close-overlay');
  const zoomContainer = document.getElementById('zoom-container');
  const zoomPreview = document.getElementById('zoom-preview');

  let scale = 1;
  let originX = 0;
  let originY = 0;
  let isDragging = false;
  let startX, startY;
  let naturalWidth = 0;
  let naturalHeight = 0;
  let maxZoomScale = 2.5; // Default max zoom

function fitAndCenterImage() {
  const containerRect = zoomContainer.getBoundingClientRect();
  const containerW = containerRect.width;
  const containerH = containerRect.height;

  const imgRatio = naturalWidth / naturalHeight;
  const containerRatio = containerW / containerH;

  if (imgRatio > containerRatio) {
    scale = containerW / naturalWidth;
    originX = 0;
    originY = (containerH - naturalHeight * scale) / 2;
  } else {
    scale = containerH / naturalHeight;
    originX = (containerW - naturalWidth * scale) / 2;
    originY = 0;
  }

  applyTransform();
  zoomPreview.textContent = `Zoom: ${Math.round(scale * 100)}%`;
}

  function applyTransform() {
    zoomedImage.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
  }

  document.querySelectorAll('img.view-original').forEach(img => {
    img.addEventListener('click', e => {
      e.preventDefault();
      const originalSrc = img.getAttribute('data-original-src') || img.src;
      zoomedImage.src = originalSrc;
      overlay.style.display = 'flex';

      zoomedImage.onload = () => {
        naturalWidth = zoomedImage.naturalWidth;
        naturalHeight = zoomedImage.naturalHeight;

        // Set max zoom based on longest side
        const longestSide = Math.max(naturalWidth, naturalHeight);
        maxZoomScale = longestSide > 2048 ? 2.5 : 5;

        fitAndCenterImage();
      };
    });

const caption = img.getAttribute('alt') || '';
document.getElementById('image-caption').textContent = caption;

// Toggle caption visibility based on CSS class
if (img.classList.contains('show-caption')) {
  overlay.classList.add('show-caption');
} else {
  overlay.classList.remove('show-caption');
}


    const preloadSrc = img.getAttribute('data-original-src');
    if (preloadSrc) {
      const preload = new Image();
      preload.src = preloadSrc;
    }
  });

  closeBtn.addEventListener('click', () => {
    overlay.style.display = 'none';
  });

  // Esc key to close
  window.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
      overlay.style.display = 'none';
    }
  });

  // Zoom with scroll (toward cursor)
zoomContainer.addEventListener('wheel', e => {
  e.preventDefault();

  const containerRect = zoomContainer.getBoundingClientRect();
  const mouseX = e.clientX - containerRect.left;
  const mouseY = e.clientY - containerRect.top;

  const delta = e.deltaY > 0 ? -0.1 : 0.1;
  const newScale = Math.min(Math.max(scale + delta, 0.5), maxZoomScale);

  // Calculate mouse position in image space
  const imgX = (mouseX - originX) / scale;
  const imgY = (mouseY - originY) / scale;

  // Adjust origin to keep mouse position stable
  originX = mouseX - imgX * newScale;
  originY = mouseY - imgY * newScale;

  scale = newScale;
  applyTransform();
  zoomPreview.textContent = `Zoom: ${Math.round(scale * 100)}%`;
});

  // Drag to pan
  zoomContainer.addEventListener('mousedown', e => {
    isDragging = true;
    startX = e.clientX - originX;
    startY = e.clientY - originY;
    zoomContainer.style.cursor = 'grabbing';
    document.body.style.userSelect = 'none';
  });

  window.addEventListener('mouseup', () => {
    isDragging = false;
    zoomContainer.style.cursor = 'grab';
    document.body.style.userSelect = '';
  });

  window.addEventListener('mousemove', e => {
    if (!isDragging) return;
    originX = e.clientX - startX;
    originY = e.clientY - startY;
    requestAnimationFrame(applyTransform);
  });

  // Double-click to reset
zoomContainer.addEventListener('dblclick', () => {
  const containerRect = zoomContainer.getBoundingClientRect();
  const containerW = containerRect.width;
  const containerH = containerRect.height;

  const fittedScaleW = containerW / naturalWidth;
  const fittedScaleH = containerH / naturalHeight;
  const fittedScale = Math.min(fittedScaleW, fittedScaleH);

  const isFitted = Math.abs(scale - fittedScale) < 0.01;

  if (isFitted) {
    // Zoom to 100%
    scale = 1;
    originX = (containerW - naturalWidth) / 2;
    originY = (containerH - naturalHeight) / 2;
  } else {
    // Fit to window
    scale = fittedScale;
    const imgRatio = naturalWidth / naturalHeight;
    const containerRatio = containerW / containerH;

    if (imgRatio > containerRatio) {
      originX = 0;
      originY = (containerH - naturalHeight * scale) / 2;
    } else {
      originX = (containerW - naturalWidth * scale) / 2;
      originY = 0;
    }
  }

  applyTransform();
  zoomPreview.textContent = `Zoom: ${Math.round(scale * 100)}%`;
});
});
</script>

<script>
// Live CSS Editor
// Ctrl + Click any element with class "style-editor" to open the editor

(function() {
Â  // Load Material Symbols font
Â  const fontLink = document.createElement('link');
Â  fontLink.href = 'https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined';
Â  fontLink.rel = 'stylesheet';
Â  document.head.appendChild(fontLink);

Â  document.addEventListener('click', function(e) {
Â  Â  if (e.ctrlKey && e.target.matches('.style-editor')) {
Â  Â  Â  e.preventDefault();
Â  Â  Â  if (document.getElementById('liveStyleEditor')) return;

Â  Â  Â  // --- STATE VARIABLES ---
Â  Â  Â  let isMinimized = false;
Â  Â  Â  let isDocked = false;
Â  Â  Â  let originalDimensions = {}; // For docking
Â  Â  Â  let preMinimizeDimensions = {}; // For minimizing
Â  Â  Â  let dockToLeft = false; // Tracks which side the dialog is docked to
Â  Â  Â  let lastHighlighted = null; // For the blue highlight on mouseover
Â  Â  Â  let lastActiveHighlighted = null; // For the red highlight on text input

Â  Â  Â  // --- CREATE UI ELEMENTS ---

Â  Â  Â  // Create wrapper
Â  Â  Â  const wrapper = document.createElement('div');
Â  Â  Â  wrapper.id = 'liveStyleEditor';
Â  Â  Â  Object.assign(wrapper.style, {
Â  Â  Â  Â  position: 'fixed',
Â  Â  Â  Â  top: '40px',
Â  Â  Â  Â  right: '10px',
Â  Â  Â  Â  width: '400px',
Â  Â  Â  Â  height: '350px',
Â  Â  Â  Â  zIndex: 9999,
Â  Â  Â  Â  background: '#fff',
Â  Â  Â  Â  border: '1px solid #ccc',
Â  Â  Â  Â  borderRadius: '8px',
Â  Â  Â  Â  padding: '10px',
Â  Â  Â  Â  fontFamily: 'monospace',
Â  Â  Â  Â  resize: 'both',
Â  Â  Â  Â  overflow: 'hidden',
Â  Â  Â  Â  boxShadow: '0 5px 15px rgba(0,0,0,0.2)',
Â  Â  Â  Â  display: 'flex',
Â  Â  Â  Â  flexDirection: 'column',
Â  Â  Â  Â  gap: '6px',
Â  Â  Â  Â  transition: 'width 0.3s ease, height 0.3s ease, top 0.3s ease, left 0.3s ease, right 0.3s ease, bottom 0.3s ease'
Â  Â  Â  });

Â  Â  Â  // Header bar
Â  Â  Â  const header = document.createElement('div');
Â  Â  Â  Object.assign(header.style, {
Â  Â  Â  Â  display: 'flex',
Â  Â  Â  Â  justifyContent: 'space-between', 
Â  Â  Â  Â  gap: '8px',
Â  Â  Â  Â  marginBottom: '4px',
Â  Â  Â  Â  cursor: 'move',
Â  Â  Â  Â  userSelect: 'none'
Â  Â  Â  });
Â  Â  Â  
Â  Â  Â  const controlButtons = document.createElement('div');
Â  Â  Â  Object.assign(controlButtons.style, {
Â  Â  Â  Â  Â  display: 'flex',
Â  Â  Â  Â  Â  gap: '8px'
Â  Â  Â  });

Â  Â  Â  const logo = document.createElement('div');
Â  Â  Â  logo.innerText = '{Live Edit CSS}';
Â  Â  Â  Object.assign(logo.style, {
Â  Â  Â  Â  Â  fontFamily: 'monospace',
Â  Â  Â  Â  Â  fontSize: '16px',
Â  Â  Â  Â  Â  fontWeight: 'bold',
Â  Â  Â  Â  Â  color: '#333',
Â  Â  Â  Â  Â  cursor: 'default',
Â  Â  Â  });
Â  Â  Â  
Â  Â  Â  // --- HEADER BUTTONS ---
Â  Â  Â  const minimizeBtn = document.createElement('span');
Â  Â  Â  minimizeBtn.className = 'material-symbols-outlined';
Â  Â  Â  minimizeBtn.innerText = 'minimize';
Â  Â  Â  minimizeBtn.title = 'Minimize';
Â  Â  Â  Object.assign(minimizeBtn.style, { fontSize: '20px', cursor: 'pointer', color: '#000' });

Â  Â  Â  const dockBtn = document.createElement('span');
Â  Â  Â  dockBtn.className = 'material-symbols-outlined';
Â  Â  Â  dockBtn.innerText = 'side_navigation';
Â  Â  Â  dockBtn.title = 'Dock to side';
Â  Â  Â  Object.assign(dockBtn.style, { fontSize: '20px', cursor: 'pointer', color: '#000', transition: 'transform 0.3s ease' });
Â  Â  Â  
Â  Â  Â  const dirIcon = document.createElement('span');
Â  Â  Â  dirIcon.className = 'material-symbols-outlined';
Â  Â  Â  dirIcon.innerText = 'dropdown';
Â  Â  Â  dirIcon.title = 'Move to corner';
Â  Â  Â  Object.assign(dirIcon.style, { fontSize: '20px', cursor: 'pointer', color: '#000', transition: 'transform 0.3s ease' });
Â  Â  Â  
Â  Â  Â  const closeBtn = document.createElement('span');
Â  Â  Â  closeBtn.className = 'material-symbols-outlined';
Â  Â  Â  closeBtn.innerText = 'close';
Â  Â  Â  closeBtn.title = 'Close';
Â  Â  Â  Object.assign(closeBtn.style, { fontSize: '20px', cursor: 'pointer', color: '#000' });

Â  Â  Â  // --- OTHER UI ELEMENTS ---
Â  Â  Â  const textarea = document.createElement('textarea');
Â  Â  Â  textarea.style.flex = '1';
Â  Â  Â  textarea.placeholder = 'Type CSS here...';
Â  Â  Â  Object.assign(textarea.style, { borderRadius: '4px', border: '1px solid #ccc' });

Â  Â  Â  const controlsRow = document.createElement('div');
Â  Â  Â  Object.assign(controlsRow.style, { display: 'flex', alignItems: 'center', justifyContent: 'space-between' });

Â  Â  Â  const formatBtn = document.createElement('button');
Â  Â  Â  formatBtn.innerText = 'Format CSS';
Â  Â  Â  Object.assign(formatBtn.style, { fontSize: '12px', padding: '4px 8px', cursor: 'pointer', fontFamily: 'monospace', border: '1px solid #ccc', borderRadius: '4px', background: '#f0f0f0' });
Â  Â  Â  
Â  Â  Â  const pinCheckbox = document.createElement('input');
Â  Â  Â  pinCheckbox.type = 'checkbox';
Â  Â  Â  pinCheckbox.id = 'pinToggle';
Â  Â  Â  const pinLabel = document.createElement('label');
Â  Â  Â  pinLabel.htmlFor = 'pinToggle';
Â  Â  Â  pinLabel.innerText = ' Pin CSS';
Â  Â  Â  Object.assign(pinLabel.style, { display: 'flex', alignItems: 'center', gap: '6px', fontFamily: 'monospace', fontSize: '14px', cursor: 'pointer' });
Â  Â  Â  pinLabel.insertBefore(pinCheckbox, pinLabel.firstChild);

Â  Â  Â  const checkbox = document.createElement('input');
Â  Â  Â  checkbox.type = 'checkbox';
Â  Â  Â  checkbox.id = 'importantToggle';
Â  Â  Â  const label = document.createElement('label');
Â  Â  Â  label.htmlFor = 'importantToggle';
Â  Â  Â  label.innerText = ' !important';
Â  Â  Â  Object.assign(label.style, { display: 'flex', alignItems: 'center', gap: '6px', fontFamily: 'monospace', fontSize: '14px', cursor: 'pointer' });
Â  Â  Â  label.insertBefore(checkbox, label.firstChild);

Â  Â  Â  const pathCheckbox = document.createElement('input');
Â  Â  Â  pathCheckbox.type = 'checkbox';
Â  Â  Â  pathCheckbox.id = 'pathToggle';
Â  Â  Â  const pathLabel = document.createElement('label');
Â  Â  Â  pathLabel.htmlFor = 'pathToggle';
Â  Â  Â  pathLabel.innerText = ' Show path (Ctrl+Click: insert selector, Ctrl+Alt+Click: insert active style)';
Â  Â  Â  Object.assign(pathLabel.style, { display: 'flex', alignItems: 'center', gap: '6px', fontFamily: 'monospace', fontSize: '14px', cursor: 'pointer' });
Â  Â  Â  pathLabel.insertBefore(pathCheckbox, pathLabel.firstChild);

Â  Â  Â  const pathDisplay = document.createElement('input');
Â  Â  Â  pathDisplay.type = 'text';
Â  Â  Â  pathDisplay.readOnly = true;
Â  Â  Â  Object.assign(pathDisplay.style, { width: '100%', fontSize: '12px', fontFamily: 'monospace', padding: '4px', border: '1px solid #ccc', background: '#f9f9f9', boxSizing: 'border-box', borderRadius: '4px' });

Â  Â  Â  const styleTag = document.createElement('style');
Â  Â  Â  document.head.appendChild(styleTag);
Â  Â  Â  

Â  Â  Â  // --- FUNCTIONS ---
Â  Â  Â  function updateStyles() {
Â  Â  Â  Â  const css = textarea.value;
Â  Â  Â  Â  styleTag.innerHTML = checkbox.checked ? addImportant(css) : css;
Â  Â  Â  }

Â  Â  Â  function addImportant(css) {
Â  Â  Â  Â  return css.replace(/([^{}]+){([^}]+)}/g, function(_, selector, rules) {
Â  Â  Â  Â  Â  var importantRules = rules.split(';').map(rule => {
Â  Â  Â  Â  Â  Â  Â  if (!rule.trim()) return '';
Â  Â  Â  Â  Â  Â  Â  return rule.includes('!important') ? rule : rule.trim() + ' !important';
Â  Â  Â  Â  Â  Â  }).join(';');
Â  Â  Â  Â  Â  return selector + '{' + importantRules + '}';
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  function formatCSS(css) {
Â  Â  Â  Â  return css.replace(/\s*{\s*/g, ' {\n Â  Â ').replace(/;\s*/g, ';\n Â  Â ').replace(/\s*}\s*/g, '\n}\n\n').replace(/\n\s*\n/g, '\n').trim();
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  function getCssPath(el) {
Â  Â  Â  Â  if (!el || el === document || el.nodeType !== 1) return '';
Â  Â  Â  Â  const path = [];
Â  Â  Â  Â  while (el && el.nodeType === 1 && el !== document.body) {
Â  Â  Â  Â  Â  let selector = el.tagName.toLowerCase();
Â  Â  Â  Â  Â  if (el.id) { selector += `#${el.id}`; path.unshift(selector); break; }
Â  Â  Â  Â  Â  if (el.className) {
Â  Â  Â  Â  Â  Â  const classes = el.className.trim().split(/\s+/).join('.');
Â  Â  Â  Â  Â  Â  if(classes) selector += `.${classes}`;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  const siblingIndex = Array.from(el.parentNode.children).indexOf(el) + 1;
Â  Â  Â  Â  Â  selector += `:nth-child(${siblingIndex})`;
Â  Â  Â  Â  Â  path.unshift(selector);
Â  Â  Â  Â  Â  el = el.parentNode;
Â  Â  Â  Â  }
Â  Â  Â  Â  return path.join(' > ');
Â  Â  Â  }


/**
 * Generates a CSS string of all explicitly set styles for a given element,
 * including inline styles and styles from linked stylesheets. This function
 * is a more accurate approach as it inspects the source styles, avoiding
 * browser-calculated values.
 *
 * @param {HTMLElement} el The element to get the styles from.
 * @returns {string} The formatted CSS string.
 */
function getActiveCssText(el) {
    // Return an empty string if no element is provided.
    if (!el) {
        console.warn("No element provided to getActiveCssText.");
        return '';
    }

    let cssText = '';
    const uniqueDeclarations = new Set();

    // Helper function to add a declaration to the set, preventing duplicates.
    const addDeclaration = (declaration) => {
        // Normalize whitespace and remove trailing semicolon
        const normalizedDecl = declaration.trim().replace(/;$/, '');
        if (normalizedDecl && !uniqueDeclarations.has(normalizedDecl)) {
            // Also filter out any declarations from the tool's highlighting logic.
            if (!normalizedDecl.startsWith('outline:')) {
                uniqueDeclarations.add(normalizedDecl);
            }
        }
    };

    // 1. Get Inline Styles (the most direct "actively assigned" styles)
    if (el.style.length > 0) {
        cssText += `/* Inline Styles */\n`;
        // Split the inline styles into individual declarations and add them.
        el.style.cssText.trim().split(';').forEach(decl => {
            if (decl.trim() !== '') {
                addDeclaration(decl);
            }
        });
    }

    // 2. Iterate through stylesheets to find matching rules
    for (const sheet of document.styleSheets) {
        try {
            for (const rule of sheet.cssRules) {
                if (rule instanceof CSSStyleRule && el.matches(rule.selectorText)) {
                    // Split the rule's styles into individual declarations and add them.
                    rule.style.cssText.trim().split(';').forEach(decl => {
                        if (decl.trim() !== '') {
                            addDeclaration(decl);
                        }
                    });
                }
            }
        } catch (e) {
            console.warn("Could not access stylesheet:", sheet.href, e);
        }
    }
    
    // Build the final CSS string from the unique declarations.
    if (uniqueDeclarations.size > 0) {
        if (cssText !== '') {
            cssText += '\n';
        }
        cssText += `/* Styles from matching rules */\n`;
        uniqueDeclarations.forEach(decl => {
            cssText += `    ${decl};\n`;
        });
    }

    return cssText;
}


Â  Â  Â  function simplifySelector(selector) {
Â  Â  Â  Â  Â  selector = " " + selector; 
Â  Â  Â  Â  Â  return selector.replace(/:nth-child\(\d+\)/g, '').replace(/\s*>\s*/g, ' ').replace(/\s+/g, ' ').trim();
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  const highlightColor = "#0077ff"; 

Â  Â  Â  function highlightElement(el) {
Â  Â  Â  Â  if (lastHighlighted && lastHighlighted !== el) { lastHighlighted.style.outline = ''; }
Â  Â  Â  Â  if (el && el !== document.body && el.nodeType === 1 && !wrapper.contains(el)) {
Â  Â  Â  Â  Â  el.style.outline = `2px dashed ${highlightColor}`;
Â  Â  Â  Â  Â  lastHighlighted = el;
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  function removeHighlight() {
Â  Â  Â  Â  Â  if (lastHighlighted) { lastHighlighted.style.outline = ''; lastHighlighted = null; }
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  function highlightActiveSelector() {
Â  Â  Â  Â  Â  if (!pathCheckbox.checked) {
Â  Â  Â  Â  Â  Â  Â  removeActiveHighlight();
Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  const text = textarea.value;
Â  Â  Â  Â  Â  const cursorPosition = textarea.selectionStart;
Â  Â  Â  
Â  Â  Â  Â  Â  const rulesRegex = /([^{}]+)\s*\{([^}]*)\}/g;
Â  Â  Â  Â  Â  let match;
Â  Â  Â  Â  Â  let activeSelector = null;
Â  Â  Â  
Â  Â  Â  Â  Â  while ((match = rulesRegex.exec(text)) !== null) {
Â  Â  Â  Â  Â  Â  Â  const selectorStart = match.index;
Â  Â  Â  Â  Â  Â  Â  const rulesEnd = match.index + match[0].length;
Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  if (cursorPosition >= selectorStart && cursorPosition <= rulesEnd) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  activeSelector = match[1].trim();
Â  Â  Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  Â  Â  if (activeSelector) {
Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  const el = document.querySelector(activeSelector);
Â  Â  Â  Â  Â  Â  Â  Â  Â  if (el) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (lastActiveHighlighted && lastActiveHighlighted !== el) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lastActiveHighlighted.style.outline = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  el.style.outline = '2px dotted red';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lastActiveHighlighted = el;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ignore invalid selectors
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  removeActiveHighlight();
Â  Â  Â  }

Â  Â  Â  function removeActiveHighlight() {
Â  Â  Â  Â  Â  if (lastActiveHighlighted) {
Â  Â  Â  Â  Â  Â  Â  lastActiveHighlighted.style.outline = '';
Â  Â  Â  Â  Â  Â  Â  lastActiveHighlighted = null;
Â  Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  function setDialogContentVisibility(visible) {
Â  Â  Â  Â  Â  const children = [formatBtn, textarea, label, pathLabel, pathDisplay, pinLabel];
Â  Â  Â  Â  Â  children.forEach(child => { child.style.display = visible ? '' : 'none'; });
Â  Â  Â  Â  Â  logo.style.display = visible ? '' : 'none';
Â  Â  Â  }

Â  Â  Â  function updateDockIconOrientation() {
Â  Â  Â  Â  if (!isDocked && !isMinimized) {
Â  Â  Â  Â  Â  const rect = wrapper.getBoundingClientRect();
Â  Â  Â  Â  Â  dockToLeft = rect.left < (window.innerWidth / 2);
Â  Â  Â  Â  Â  dockBtn.style.transform = dockToLeft ? 'scaleX(-1)' : 'scaleX(1)';
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  // --- LOCAL STORAGE FUNCTIONS ---
Â  Â  Â  function loadPinnedCss() {
Â  Â  Â  Â  Â  const pinned = localStorage.getItem('liveCssPinned');
Â  Â  Â  Â  Â  const content = localStorage.getItem('liveCssContent');
Â  Â  Â  Â  Â  if (pinned === 'true' && content) {
Â  Â  Â  Â  Â  Â  Â  pinCheckbox.checked = true;
Â  Â  Â  Â  Â  Â  Â  textarea.value = content;
Â  Â  Â  Â  Â  Â  Â  updateStyles();
Â  Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  function togglePinCss() {
Â  Â  Â  Â  Â  if (pinCheckbox.checked) {
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('liveCssPinned', 'true');
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('liveCssContent', textarea.value);
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('liveCssPinned');
Â  Â  Â  Â  Â  Â  Â  localStorage.removeItem('liveCssContent');
Â  Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  function saveCssIfPinned() {
Â  Â  Â  Â  Â  if (pinCheckbox.checked) {
Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('liveCssContent', textarea.value);
Â  Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  const pathMouseMoveHandler = e => {
Â  Â  Â  Â  if (!wrapper.contains(e.target) && pathCheckbox.checked) {
Â  Â  Â  Â  Â  Â  removeActiveHighlight();
Â  Â  Â  Â  Â  Â  highlightElement(e.target);
Â  Â  Â  Â  Â  Â  const path = getCssPath(e.target);
Â  Â  Â  Â  Â  Â  const simplifiedPath = simplifySelector(path);
Â  Â  Â  Â  Â  Â  pathDisplay.value = simplifiedPath;
Â  Â  Â  Â  } else if (wrapper.contains(e.target) && lastHighlighted) {
Â  Â  Â  Â  Â  Â  removeHighlight();
Â  Â  Â  Â  } else if (!pathCheckbox.checked) {
Â  Â  Â  Â  Â  Â  removeHighlight();
Â  Â  Â  Â  Â  Â  removeActiveHighlight();
Â  Â  Â  Â  Â  Â  pathDisplay.value = '';
Â  Â  Â  Â  }
Â  Â  Â  };

Â  Â  Â  const pathClickHandler = function insertPathOrStyle(e) {
Â  Â  Â  Â  Â  if (pathCheckbox.checked && e.ctrlKey && !wrapper.contains(e.target)) {
Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  const targetElement = e.target;
Â  Â  Â  Â  Â  Â  Â  const simplifiedPath = simplifySelector(getCssPath(targetElement));
Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if (e.altKey) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const activeCss = getActiveCssText(targetElement);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newRule = `${simplifiedPath} {\n${activeCss}}\n\n`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  textarea.value += newRule;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateStyles();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!textarea.value.includes(simplifiedPath)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const newRule = `${simplifiedPath} {\n Â  Â \n}\n\n`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  textarea.value += newRule;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateStyles();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â  
Â  Â  Â  const handleMouseOut = (e) => {
Â  Â  Â  Â  Â  if (e.relatedTarget && wrapper.contains(e.relatedTarget)) { return; }
Â  Â  Â  Â  Â  if (isDocked) {
Â  Â  Â  Â  Â  Â  Â  if (dockToLeft) { wrapper.style.left = '-392px'; } 
Â  Â  Â  Â  Â  Â  Â  else { wrapper.style.right = '-392px'; }
Â  Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â  
Â  Â  Â  const handleMouseOver = () => {
Â  Â  Â  Â  Â  if (isDocked) {
Â  Â  Â  Â  Â  Â  Â  if (dockToLeft) { wrapper.style.left = '0px'; } 
Â  Â  Â  Â  Â  Â  Â  else { wrapper.style.right = '0px'; }
Â  Â  Â  Â  Â  }
Â  Â  Â  };
Â  Â  Â  
Â  Â  Â  // --- EVENT LISTENERS (and their removal on close) ---
Â  Â  Â  closeBtn.addEventListener('click', () => {
Â  Â  Â  Â  if (!pinCheckbox.checked) {
Â  Â  Â  Â  Â  Â  localStorage.removeItem('liveCssPinned');
Â  Â  Â  Â  Â  Â  localStorage.removeItem('liveCssContent');
Â  Â  Â  Â  }
Â  Â  Â  Â  removeHighlight();
Â  Â  Â  Â  removeActiveHighlight();
Â  Â  Â  Â  wrapper.remove();
Â  Â  Â  Â  styleTag.remove();
Â  Â  Â  Â  
Â  Â  Â  Â  document.removeEventListener('mousemove', pathMouseMoveHandler);
Â  Â  Â  Â  document.removeEventListener('click', pathClickHandler, { capture: true });
Â  Â  Â  Â  wrapper.removeEventListener('mouseover', handleMouseOver);
Â  Â  Â  Â  wrapper.removeEventListener('mouseout', handleMouseOut);
Â  Â  Â  Â  textarea.removeEventListener('input', highlightActiveSelector);
Â  Â  Â  Â  textarea.removeEventListener('click', highlightActiveSelector);
Â  Â  Â  Â  textarea.removeEventListener('blur', removeActiveHighlight);
Â  Â  Â  Â  pathCheckbox.removeEventListener('change', removeActiveHighlight);
Â  Â  Â  });
Â  Â  Â  
Â  Â  Â  minimizeBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  if (!isMinimized) {
Â  Â  Â  Â  Â  Â  Â  const rect = wrapper.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  Â  preMinimizeDimensions = { top: `${rect.top}px`, left: `${rect.left}px`, width: `${rect.width}px`, height: `${rect.height}px` };
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  isMinimized = !isMinimized;
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  setDialogContentVisibility(!isMinimized);
Â  Â  Â  Â  Â  wrapper.style.resize = isMinimized ? 'none' : 'both';
Â  Â  Â  Â  Â  minimizeBtn.innerText = isMinimized ? 'crop_square' : 'minimize';
Â  Â  Â  Â  Â  minimizeBtn.title = isMinimized ? 'Maximize' : 'Minimize';

Â  Â  Â  Â  Â  if (isMinimized) {
Â  Â  Â  Â  Â  Â  Â  wrapper.style.height = 'auto';
Â  Â  Â  Â  Â  Â  Â  wrapper.style.width = 'auto';
Â  Â  Â  Â  Â  Â  Â  wrapper.style.padding = '4px 10px'; 
Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  const rect = { top: parseFloat(preMinimizeDimensions.top), left: parseFloat(preMinimizeDimensions.left), bottom: parseFloat(preMinimizeDimensions.top) + parseFloat(preMinimizeDimensions.height), right: window.innerWidth - (parseFloat(preMinimizeDimensions.left) + parseFloat(preMinimizeDimensions.width)) };
Â  Â  Â  Â  Â  Â  Â  const dist = { top: rect.top, bottom: window.innerHeight - rect.bottom, left: rect.left, right: rect.right };
Â  Â  Â  Â  Â  Â  Â  const closestEdge = Object.keys(dist).reduce((a, b) => dist[a] < dist[b] ? a : b);
Â  Â  Â  Â  Â  Â  Â  wrapper.style.top = wrapper.style.bottom = wrapper.style.left = wrapper.style.right = '';

Â  Â  Â  Â  Â  Â  Â  switch (closestEdge) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  case 'top': Â  Â  wrapper.style.top = '0px'; wrapper.style.left = preMinimizeDimensions.left; break;
Â  Â  Â  Â  Â  Â  Â  Â  Â  case 'bottom': Â wrapper.style.bottom = '0px'; wrapper.style.left = preMinimizeDimensions.left; break;
Â  Â  Â  Â  Â  Â  Â  Â  Â  case 'left': Â  Â wrapper.style.left = '0px'; wrapper.style.top = preMinimizeDimensions.top; break;
Â  Â  Â  Â  Â  Â  Â  Â  Â  case 'right': Â  wrapper.style.right = '0px'; wrapper.style.top = preMinimizeDimensions.top; break;
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Object.assign(wrapper.style, { ...preMinimizeDimensions, padding: '10px', right: '', bottom: '' });
Â  Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  
Â  Â  Â  dockBtn.addEventListener('click', () => {
Â  Â  Â  Â  if (isMinimized) { minimizeBtn.click(); }
Â  Â  Â  Â  isDocked = !isDocked;
Â  Â  Â  Â  if (isDocked) {
Â  Â  Â  Â  Â  Â  const rect = wrapper.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  originalDimensions = { top: `${rect.top}px`, left: `${rect.left}px`, width: `${rect.width}px`, height: `${rect.height}px` };
Â  Â  Â  Â  Â  Â  Object.assign(wrapper.style, { top: '0px', left: dockToLeft ? '0px' : '', right: dockToLeft ? '' : '0px', bottom: '0px', width: '400px', height: '100vh', resize: 'none', borderRadius: '0', transition: 'left 0.3s ease, right 0.3s ease' });
Â  Â  Â  Â  Â  Â  minimizeBtn.style.display = 'none';
Â  Â  Â  Â  Â  Â  logo.style.display = 'none';
Â  Â  Â  Â  Â  Â  dockBtn.title = 'Undock';
Â  Â  Â  Â  Â  Â  dockBtn.style.transform = dockToLeft ? 'scaleX(-1)' : 'scaleX(1)';
Â  Â  Â  Â  Â  Â  wrapper.addEventListener('mouseover', handleMouseOver);
Â  Â  Â  Â  Â  Â  wrapper.addEventListener('mouseout', handleMouseOut);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Object.assign(wrapper.style, { ...originalDimensions, resize: 'both', borderRadius: '8px', transition: 'width 0.3s ease, height 0.3s ease, top 0.3s ease, left 0.3s ease, right 0.3s ease, bottom 0.3s ease' });
Â  Â  Â  Â  Â  Â  minimizeBtn.style.display = '';
Â  Â  Â  Â  Â  Â  logo.style.display = '';
Â  Â  Â  Â  Â  Â  dockBtn.title = 'Dock to side';
Â  Â  Â  Â  Â  Â  updateDockIconOrientation();
Â  Â  Â  Â  Â  Â  wrapper.removeEventListener('mouseover', handleMouseOver);
Â  Â  Â  Â  Â  Â  wrapper.removeEventListener('mouseout', handleMouseOut);
Â  Â  Â  Â  }
Â  Â  Â  });

Â  Â  Â  const cornerPositions = {
Â  Â  Â  Â  'top-right': Â  Â { top: '10px', right: '10px', bottom: '', Â left: '', Â transform: 'rotate(90deg)' },
Â  Â  Â  Â  'bottom-right': { top: '', Â  Â right: '10px', bottom: '10px', left: '', Â transform: 'rotate(180deg)' },
Â  Â  Â  Â  'bottom-left': Â { top: '', Â  Â right: '', Â  Â bottom: '10px', left: '10px', transform: 'rotate(-90deg)' },
Â  Â  Â  Â  'top-left': Â  Â  { top: '10px', right: '', Â  Â bottom: '', Â left: '10px', transform: 'rotate(0deg)' }
Â  Â  Â  };
Â  Â  Â  const cornerKeys = Object.keys(cornerPositions);
Â  Â  Â  let currentCornerIndex = 0;
Â  Â  Â  dirIcon.style.transform = cornerPositions[cornerKeys[currentCornerIndex]].transform;

Â  Â  Â  dirIcon.addEventListener('click', () => {
Â  Â  Â  Â  Â  if (isDocked) { dockBtn.click(); }
Â  Â  Â  Â  Â  if (isMinimized) { minimizeBtn.click(); }
Â  Â  Â  Â  Â  currentCornerIndex = (currentCornerIndex + 1) % cornerKeys.length;
Â  Â  Â  Â  Â  const newPosition = cornerPositions[cornerKeys[currentCornerIndex]];
Â  Â  Â  Â  Â  Object.assign(wrapper.style, { top: newPosition.top, right: newPosition.right, bottom: newPosition.bottom, left: newPosition.left });
Â  Â  Â  Â  Â  dirIcon.style.transform = newPosition.transform;
Â  Â  Â  Â  Â  updateDockIconOrientation();
Â  Â  Â  });

Â  Â  Â  textarea.addEventListener('input', () => {
Â  Â  Â  Â  updateStyles();
Â  Â  Â  Â  saveCssIfPinned();
Â  Â  Â  Â  highlightActiveSelector();
Â  Â  Â  });
Â  Â  Â  checkbox.addEventListener('change', updateStyles);
Â  Â  Â  formatBtn.addEventListener('click', () => {
Â  Â  Â  Â  textarea.value = formatCSS(textarea.value);
Â  Â  Â  Â  updateStyles();
Â  Â  Â  Â  saveCssIfPinned();
Â  Â  Â  });
Â  Â  Â  pinCheckbox.addEventListener('change', togglePinCss);
Â  Â  Â  textarea.addEventListener('blur', removeActiveHighlight);
Â  Â  Â  textarea.addEventListener('click', highlightActiveSelector);
Â  Â  Â  pathCheckbox.addEventListener('change', () => {
Â  Â  Â  Â  Â  if (!pathCheckbox.checked) { removeActiveHighlight(); }
Â  Â  Â  });

Â  Â  Â  document.addEventListener('mousemove', pathMouseMoveHandler);
Â  Â  Â  document.addEventListener('click', pathClickHandler, { capture: true });

Â  Â  Â  header.addEventListener('mousedown', function(e) {
Â  Â  Â  Â  Â  if (isDocked || isMinimized) return;
Â  Â  Â  Â  Â  let offsetX = e.clientX - wrapper.getBoundingClientRect().left;
Â  Â  Â  Â  Â  let offsetY = e.clientY - wrapper.getBoundingClientRect().top;
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  function mouseMoveHandler(e) {
Â  Â  Â  Â  Â  Â  Â  wrapper.style.left = `${e.clientX - offsetX}px`;
Â  Â  Â  Â  Â  Â  Â  wrapper.style.top = `${e.clientY - offsetY}px`;
Â  Â  Â  Â  Â  Â  Â  wrapper.style.right = '';
Â  Â  Â  Â  Â  Â  Â  wrapper.style.bottom = '';
Â  Â  Â  Â  Â  Â  Â  updateDockIconOrientation();
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  function mouseUpHandler() {
Â  Â  Â  Â  Â  Â  Â  document.removeEventListener('mousemove', mouseMoveHandler);
Â  Â  Â  Â  Â  Â  Â  document.removeEventListener('mouseup', mouseUpHandler);
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  document.addEventListener('mousemove', mouseMoveHandler);
Â  Â  Â  Â  Â  document.addEventListener('mouseup', mouseUpHandler);
Â  Â  Â  });

Â  Â  Â  // Assemble editor
Â  Â  Â  controlButtons.appendChild(minimizeBtn);
Â  Â  Â  controlButtons.appendChild(dockBtn);
Â  Â  Â  controlButtons.appendChild(dirIcon);
Â  Â  Â  controlButtons.appendChild(closeBtn);
Â  Â  Â  header.appendChild(logo);
Â  Â  Â  header.appendChild(controlButtons);
Â  Â  Â  controlsRow.appendChild(formatBtn);
Â  Â  Â  controlsRow.appendChild(pinLabel);
Â  Â  Â  wrapper.appendChild(header);
Â  Â  Â  wrapper.appendChild(controlsRow);
Â  Â  Â  wrapper.appendChild(textarea);
Â  Â  Â  wrapper.appendChild(label);
Â  Â  Â  wrapper.appendChild(pathLabel);
Â  Â  Â  wrapper.appendChild(pathDisplay);
Â  Â  Â  document.body.appendChild(wrapper);

Â  Â  Â  // Initial calls
Â  Â  Â  updateDockIconOrientation();
Â  Â  Â  loadPinnedCss();
}
Â  Â  });
})();

</script>


</body>
</html>



