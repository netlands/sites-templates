<style>
  /* styles go here */
  .hidden {
    display: none;
  }  
  img.logodark {
    filter: invert(1);
  }

</style>
<script>
  /*/ script code goes here */
window.addEventListener('DOMContentLoaded', () => {
  
  const regex = /%([^\s%]+)%/g;
  const skipTags = new Set(['SCRIPT', 'STYLE', 'NOSCRIPT', 'TEXTAREA', 'INPUT', 'SELECT']);

  function wrapMatches(node) {
    if (node.nodeType === Node.TEXT_NODE && node.parentNode && !skipTags.has(node.parentNode.nodeName)) {
      const text = node.textContent;
      if (!regex.test(text)) return;

      const frag = document.createDocumentFragment();
      let lastIndex = 0;
      text.replace(regex, (match, p1, offset) => {
        frag.append(text.slice(lastIndex, offset));
        const span = document.createElement('span');
        span.className = 'hidden';
        span.textContent = `%${p1}%`;
        frag.append(span);
        lastIndex = offset + match.length;
      });
      frag.append(text.slice(lastIndex));
      node.parentNode.replaceChild(frag, node);
    } else if (node.nodeType === Node.ELEMENT_NODE && !skipTags.has(node.nodeName)) {
      node.childNodes.forEach(wrapMatches);
    }
  }

  wrapMatches(document.body);
  
  if (document.body.textContent.includes('%logodark%')) {
    console.log("yay!");
    document.querySelectorAll('header a[href="/home"] img').forEach((img, i) => {
      console.log(`Image ${i}:`, img.className);
      img.classList.add('logodark'); // this is safe even if the class is already present
    });
  }
 
});
  
</script>
