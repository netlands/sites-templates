<style>
  /* styles go here */
  .hidden {
    display: none;
  }  
  img.logodark {
    filter: brightness(0) saturate(100%) invert(57%) sepia(5%) saturate(305%) hue-rotate(169deg) brightness(91%) contrast(84%);
  }

</style>
<script>
  /*/ script code goes here */
window.addEventListener('DOMContentLoaded', () => {


    const url = new URL(window.location.href);
    
    if (url.pathname === "/" || window.location.pathname === "/en" || window.location.pathname === "/ja") {
        document.body.classList.add("first-page");
    }

    window.addEventListener("scroll", function() {
        if (window.scrollY > 50) {
            document.body.classList.add("scrolled");
        } else {
            document.body.lassList.remove("scrolled");
        }
    });
  
  
  const regex = /%([^\s%]+)%/g;
  const skipTags = new Set(['SCRIPT', 'STYLE', 'NOSCRIPT', 'TEXTAREA', 'INPUT', 'SELECT']);

  function wrapMatches(node) {
    if (node.nodeType === Node.TEXT_NODE && node.parentNode && !skipTags.has(node.parentNode.nodeName)) {
      const text = node.textContent;
      if (!regex.test(text)) return;

      const frag = document.createDocumentFragment();
      let lastIndex = 0;
      text.replace(regex, (match, p1, offset) => {
        frag.append(text.slice(lastIndex, offset));
        const span = document.createElement('span');
        span.className = 'hidden';
        span.textContent = `%${p1}%`;
        frag.append(span);
        lastIndex = offset + match.length;
      });
      frag.append(text.slice(lastIndex));
      node.parentNode.replaceChild(frag, node);
    } else if (node.nodeType === Node.ELEMENT_NODE && !skipTags.has(node.nodeName)) {
      node.childNodes.forEach(wrapMatches);
    }
  }

  wrapMatches(document.body);
  
function getVisibleTextContent(root = document.body) {
  const skipTags = new Set(['SCRIPT', 'STYLE', 'NOSCRIPT', 'TEMPLATE']);
  let text = '';

  function walk(node) {
    if (skipTags.has(node.nodeName)) return;

    if (node.nodeType === Node.TEXT_NODE) {
      text += node.textContent;
    } else if (node.nodeType === Node.ELEMENT_NODE) {
      for (const child of node.childNodes) {
        walk(child);
      }
    }
  }

  walk(root);
  return text;
}

if (getVisibleTextContent().includes('%logodark%')) {
    document.querySelectorAll('header a[href="/home"] img').forEach((img, i) => {
      console.log(`Image ${i}:`, img.className);
      img.classList.add('logodark'); // this is safe even if the class is already present
    });
  }
 
});
  
</script>
